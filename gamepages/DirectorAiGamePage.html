<!DOCTYPE HTML>
<html lang="en">
<head>
  <title>Charlie Evans | Portfolio</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="../assets/css/main.css" />
  <link rel="shortcut icon" type="image/png" href="../images/favicon_icon.png">
  <script src="https://kit.fontawesome.com/df8cc90f86.js" crossorigin="anonymous"></script>
  <noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-35MEBTFD4P"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-35MEBTFD4P');
</script>

<body> <!--class="is-preload"-->
<!-- Wrapper -->
<div id="wrapper">

  <!-- Header -->
  <header id="header" style="max-width: 50em; margin: 0 auto;">
    <div class="inner">

      <!-- Nav -->
      <nav>
        <ul>
          <li><a href="#menu">Menu</a></li>
        </ul>
      </nav>

    </div>
  </header>

  <!-- Menu -->
  <nav id="menu">
    <h2 style="color: #6fffbe;">Menu</h2>
    <ul>
      <li><a href="../index.html">Portfolio</a></li>
      <li><a href="../skillspage.html">Skills</a></li>
      <li><a href="../blogpage.html">Blog</a></li>
      <li><a href="../documents/CV.pdf" target="_blank">CV</a></li>
    </ul>

    <br>
    <section>
      <ul class="icons" style="font-size: 0.75em; text-align: center;">
        <li><a href="https://github.com/charlie2099" target="_blank" class="fab fa-github icon brands"><span class="label">GitHub</span></a></li>
        <li><a href="https://charlie2099.itch.io/" target="_blank" class="fab fa-itch-io icon brands"><span class="label">Itch Io</span></a></li>
        <li><a href="https://www.linkedin.com/in/charlie-evans-5bbaa3200" target="_blank" class="fab fa-linkedin icon brands"><span class="label">Linkedin</span></a></li>
        <li><a href="https://twitter.com/charlieevans203" target="_blank" class="fab fa-twitter icon brands"><span class="label">Twitter</span></a></li>
        <li><a href="https://uwegames.slack.com/team/U02H9M78J6A" target="_blank" class="fab fa-slack icon brands"><span class="label">Slack</span></a></li>
        <li><a href="mailto:charlie.evans2499@gmail.com" target="_blank" class="fab fa-envelope icon"><span class="label">Email</span></a></li>
      </ul>
      <p style="text-align: center;">&copy; Charlie Evans. All rights reserved. | Homepage Design Template: <a href="https://html5up.net/phantom" target="_blank">Phantom HTML5 UP</a></p>
    </section>
  </nav>

  <!-- Main -->
  <div id="main" style="max-width: 50em; margin: 0 auto;">
    <div class="inner" style="box-shadow: inset 0px 0px 0px 1px rgb(0, 0, 0), 0px 2px 4px 0px rgb(0, 0, 0); background-color: #1b1c26; border-radius: 10px;"> <!--#272938--> <!--#1b1c26-->
        
      <br>
        
      <a href="../blogpage.html" style="float: right; margin-top: 10px; margin-left: 3px; margin-right: 3px; color: rgba(255, 255, 255, 0.5);"><button class="btn fa fa-edit"></button></a>
      <a href="../skillspage.html" style="float: right; margin-top: 10px; margin-left: 3px; margin-right: 3px; color: rgba(255, 255, 255, 0.5);"><button class="btn fa fa-list-alt"></button></a>
      <a href="../index.html" style="float: right; margin-top: 10px; margin-left: 3px; margin-right: 3px; color: rgba(255, 255, 255, 0.5);"><button class="btn fa fa-home"></button></a>

      <h3 style="border-bottom: 2px solid #6fffbe; padding: 20px; font-size: 0.85em;"><strong style="color: rgb(132,255,128); font-weight: normal;"><span class="fa solid fa-file-lines"></span> Project Page <span style="color: rgba(255, 255, 255, 1);">| Director Ai</span> </strong></h3>
      
      <a href="../blogpage.html"><button class="btn"> <span class="fa-solid fa-arrow-circle-left"></span> <span style="font-family: sansation_light; font-weight: normal; font-size: 1.1em; ">Back</span></button></a>
      
      <h1 class="blogheader1">Director Ai for Shooter and Survival Games</h1>
      <h4 style="color: rgba(255,255,255,0.5); font-weight: normal; text-align: center;">Jan 30th, 2023 <span style="color: #6fffbe;">(Updated: Feb 15th)</span></h4>
        
      <br>
      <video class="projecttileimage" autoplay muted loop>
        <source src="../images/GIFS/DirectorAiDemo.webm" type=video/webm>
      </video>

      <br>
      <br>
      <a href="#codesamples"><button class="btn fa solid fa-code" style="color: rgb(132,123,255);"> <span style="color: white; font-family: sansation_light; font-weight: normal;">Code Samples</span></button></a>
      
      <br>
      <br>
      <span class="fa-solid fa-book-open" style="color: rgb(255,255,255); margin-top: 0.35em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" style="color: white;">Project Overview</h2>
      <p>An Ai Director is a system that manages the intensity and flow of the player's experience. It is used to 
          dynamically control the difficulty and progression of the game in real time based on player performance, 
          and aims to create a unique and challenging experience on each play so that no two games are the same.
          This typically involves the Director deciding when and where to spawn enemies, how many enemies should 
          be in play at any one time, and modifying the level layout to open up new paths dynamically. 
        <!--Such a system is popularly employed in the survival horror genre, with Left 4 Dead being a perfect example
        of how such a system can be successful deployed to create novel experiences.--></p>
      
      <p>The goal for this project was to create a versatile Director Ai system that 
        would allow designers to build their own rules and behaviours for games of 
        the shooter and survival genre.</p>
        
      <br>
      <span class="fa-solid fa-exclamation-triangle" style="color: rgb(255,255,255); margin-top: 0.39em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" style="color: white;">Technical Challenges</h2>
      <p>Constructing a flexible rules system for the Director to utilise effectively for both shooter and survival games proved to be a challenging task. It was important that rules could be processed for both game
      genres by a single system.</p>
      <p>...</p>

      <br>
      <span class="fa-solid fa-face-smile" style="color: rgb(123,255,134); margin-top: 0.36em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" style="color: white;">Features</h2> <!--What Went Well?-->
      <ul>
          <li><span style="color: #6fffbe; font-weight: bold;">Highly Customisable<!--and Data-driven--></span> - Designers can tweak and customise the director according to their own needs and preferences.</li>
          <li><span style="color: #6fffbe; font-weight: bold;">Flexible Rule Processing System</span> - Rules for both shooter and survival games can be processed by the system with the capability to adapt to other genre types.</li>
          <li><span style="color: #6fffbe; font-weight: bold;">Easy Deployment</span> - Simply drop the director prefab into the scene and then drag-and-drop the necessary requirements for the inspector (such as a reference to the player).</li>
      </ul>
        
      <span class="fa-solid fa-face-frown" style="color: rgb(255,123,123); margin-top: 0.4em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" style="color: white;">Limitations</h2> <!--What Didn't Go So Well?-->
        <ul>
            <li><span style="color: #6fffbe; font-weight: bold;">Rules Must Be Manually Added<!--and Data-driven--></span> - Designers are required to access the code directly to write rules and add them to the rules list.
                A custom editor tool should be built that will allow a designer to easily create and add rules to the rule engine without having to access the code directly.</li>
            <li><span style="color: #6fffbe; font-weight: bold;">Lack of Rule Evaluation Techniques</span> - Intensity rules are only fired based on the highest weighting output. Further techniques could be employed such 
                as executing rules sequentially, at random, based on priority, or firing the first to match a condition.</li>
        </ul>
        
        <!--<p>A limitation of the existing rules system is that it requires designers to
            <span style="color: white;">manually add their rules</span> to to the rule 
            calculator class so that it can be used in the rule engine calculation. Ideally a 
            <span style="color: white;">custom editor tool should be built</span> that will
            <span style="color: white;">allow a designer to easily create and add rules to the 
                rule engine</span> without having to access the code directly.</p>
        
        <p>Another limitation of the current system is the <span style="color: white;">
            lack of rule evaluation techniques employed</span>. Intensity rules are
            <span style="color: white;">only fired based on the highest intensity
                weighting output</span>, however further techniques could be introduced. Some 
            examples include <span style="color: white;">executing rules sequentially</span>, 
            <span style="color: white;">at random</span>, 
            <span style="color: white;">based on priority</span>, or firing the
            <span style="color: white;">first to match a condition</span>.</p>-->
        
      <span class="fa-solid fa-lightbulb" style="color: rgb(255,237,123); margin-top: 0.35em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" style="color: white;">What I Learnt</h2>
      <ul>
          <li>The Rule Pattern - Abstracting messy logic into their own respective rule classes.</li>
          <li>The State Pattern</li>
          <li>...</li>
      </ul>
        
      <span class="fa-solid fa-pencil" style="color: rgb(255,255,255); margin-top: 0.45em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" style="color: white;">Future Improvements</h2>
      <ul>
          <li>Rework director state logic using a state machine<span class="fa-solid fa-check-square" style="margin-left: 0.5em; font-size: 1em; color: greenyellow;"></span></li>
          <li>Utilise more methods of rule execution<span class="fa-solid fa-square" style="margin-left: 0.5em; font-size: 1em;"></span></li>
          <li>Rule creation using a custom editor tool<span class="fa-solid fa-square" style="margin-left: 0.5em; font-size: 1em;"></span></li>
          <li>Adapt the active area set to work with 3D environments<span class="fa-solid fa-square" style="margin-left: 0.5em; font-size: 1em;"></span></li>
      </ul>
      
      <span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.355em; margin-right: 0.5em; float: left; font-size: 1.3em;"></span><h2 class="blogheader2" id="codesamples" style="color: white;">Code Samples</h2>
      <style>.background{font-family:monaco,Consolas,LucidaConsole,monospace;color:#dfdfdf;}.method{color:#39ca8c;}.class{color:#bf90fd;}.keyword{color:#6b94e7;}.string{color:#C9A26D;}.interface{color:#bf90fd;}.enumName{color: #E1BFFF;}  .numericLiteral{color:#ED94C0;}  .control{color:#6b94e7;}  .namespace{color:#dfdfdf;}  .enumMember{color:#dfdfdf;}  .identifier{color:#dfdfdf;}  .punctuation{color:#dfdfdf;}  .operator{color:#dfdfdf;}  .propertyName{color:#dfdfdf;}  .fieldName{color:#dfdfdf;}  .localName{color:#9CDCFE;}  .parameter{color:#BDBDBD;}</style>
      <!-- code styling generated by https://github.com/Swiftly1/CsharpToColouredHTML -->

      <!--============================-->
      <!--Code Snippet x - Placeholder -->
      <!--============================-->
      <!--<button type="button" class="collapsible" style="width: 100%;"><span class="fa-solid fa-code" style="color: rgb(132,123,255);  margin-right: 0.5em; float: left; font-size: 1em;"></span>Placeholder</button>
      <div class="collapsibleblock">
  
      <br>
      <pre ><code><span class="keyword">public interface</span> <span class="interface">IDirectorIntensityRule</span>
  {
      <span class="keyword">public float</span> <span class="method">CalculatePerceivedIntensity</span>(<span class="class">Director</span> <span class="parameter">director</span>);
  }</code>
      </pre>
      </div>-->

        
      <h3 class="blogheader3">Core</h3>
      <!--===================================-->
      <!--Code Snippet 4 - Director Singleton-->
      <!--===================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public enum</span> <span class="enumName">DirectorEvent</span>
{
    EnteredNewState,
    EnteredRespiteState,
    EnteredBuildUpState,
    EnteredPeakState,
    EnteredPeakFadeState,
    ReachedPeakIntensity
}</code>
        </pre>


        <br>
        <pre class="background"><code><span class="keyword">public class</span> <span class="class">Director</span> : <span class="class">MonoBehaviour</span>
{
    <span class="keyword">public static</span> <span class="class">Director</span> Instance;

    <span class="keyword">private enum</span> <span class="enumName">Difficulty</span>
    {
        Easy = <span class="numericLiteral">0</span>,
        Normal = <span class="numericLiteral">1</span>,
        Hard = <span class="numericLiteral">2</span>
    }

    [<span class="class">SerializeField</span>] <span class="keyword">private</span> <span class="enumName">Difficulty</span> difficulty;
    <span class="keyword">private</span> <span class="class">Dictionary</span>&lt;<span class="enumName">Difficulty</span>, <span class="keyword">float</span>&gt; _intensityModifierDict;

    [<span class="class">Header</span>(<span class="string">&quot;INTENSITY&quot;</span>)] [<span class="class">SerializeField</span>] <span class="keyword">private float</span> intensityCalculationRate = <span class="numericLiteral">0.5f</span>;

    [<span class="class">Header</span>(<span class="string">&quot;TEMPO&quot;</span>)] [<span class="class">SerializeField</span>] [<span class="class">Range</span>(<span class="numericLiteral">70</span>, <span class="numericLiteral">100</span>)]
    <span class="keyword">private int</span> peakIntensityThreshold;

    [<span class="class">Space</span>] [<span class="class">Tooltip</span>(<span class="string">&quot;Default value, but can be dynamically altered by the Director&quot;</span>)] [<span class="class">SerializeField</span>]
    <span class="keyword">private float</span> defaultPeakDuration;

    [<span class="class">SerializeField</span>] <span class="keyword">private float</span> defaultRespiteDuration;
    [<span class="class">Space</span>] [<span class="class">SerializeField</span>] <span class="keyword">private int</span> maxBuildUpPopulation;
    [<span class="class">SerializeField</span>] <span class="keyword">private int</span> maxPeakPopulation;
    [<span class="class">SerializeField</span>] <span class="keyword">private int</span> maxRespitePopulation;

    [<span class="class">Header</span>(<span class="string">&quot;ENEMY DATA&quot;</span>)] [<span class="class">SerializeField</span>]
    <span class="keyword">private</span> <span class="class">List</span>&lt;<span class="class">GameObject</span>&gt; activeEnemies = <span class="keyword">new</span>();
    [<span class="class">SerializeField</span>] <span class="keyword">private int</span> maxPopulationCount;

    [<span class="class">Header</span>(<span class="string">&quot;PLAYER DATA&quot;</span>)] [<span class="class">SerializeField</span>]
    <span class="keyword">private</span> Player player;

    <span class="keyword">public float</span> RespiteDuration { <span class="keyword">get</span>; <span class="keyword">set</span>; }
    <span class="keyword">public float</span> PeakDuration { <span class="keyword">get</span>; <span class="keyword">set</span>; }
    <span class="keyword">public int</span> MaxPopulationCount { <span class="keyword">get</span>; <span class="keyword">set</span>; }

    <span class="keyword">private readonly</span> StateMachine _stateMachine = <span class="keyword">new</span>();
    <span class="keyword">private</span> <span class="class">Dictionary</span>&lt;<span class="class">Type</span>, <span class="interface">IState</span>&gt; _cachedIntensityStatesDict;

    <span class="keyword">private readonly</span> DirectorIntensityCalculator _intensityCalculator = <span class="keyword">new</span>();
    <span class="keyword">private float</span> _perceivedIntensity;

    <span class="keyword">private void</span> <span class="method">OnEnable</span>() =&gt; _stateMachine.OnStateChanged += <span class="method">StateMachineOnStateChangedEvent</span>;
    <span class="keyword">private void</span> <span class="method">OnDisable</span>() =&gt; _stateMachine.OnStateChanged -= <span class="method">StateMachineOnStateChangedEvent</span>;

    <span class="keyword">private void</span> <span class="method">Awake</span>()
    {
        <span class="control">if</span> (Instance == <span class="keyword">null</span>)
        {
            Instance = <span class="keyword">this</span>;
        }
        <span class="control">else</span>
        {
            <span class="class">Debug</span>.<span class="method">LogError</span>(<span class="string">&quot;Only one instance of the Director should exist at any one time&quot;</span>);
        }
    }

    <span class="keyword">private void</span> <span class="method">Start</span>()
    {
        RespiteDuration = defaultRespiteDuration;
        PeakDuration = defaultPeakDuration;

        _cachedIntensityStatesDict = <span class="keyword">new</span> <span class="class">Dictionary</span>&lt;<span class="class">Type</span>, <span class="interface">IState</span>&gt;
        {
            {<span class="keyword">typeof</span>(<span class="class">DirectorRespiteState</span>), <span class="keyword">new</span> <span class="class">DirectorRespiteState</span>(<span class="keyword">this</span>, _stateMachine)},
            {<span class="keyword">typeof</span>(<span class="class">DirectorBuildUpState</span>), <span class="keyword">new</span> <span class="class">DirectorBuildUpState</span>(<span class="keyword">this</span>, _stateMachine)},
            {<span class="keyword">typeof</span>(<span class="class">DirectorPeakState</span>), <span class="keyword">new</span> <span class="class">DirectorPeakState</span>(<span class="keyword">this</span>, _stateMachine)},
            {<span class="keyword">typeof</span>(<span class="class">DirectorPeakFadeState</span>), <span class="keyword">new</span> <span class="class">DirectorPeakFadeState</span>(<span class="keyword">this</span>, _stateMachine)}
        };
        _stateMachine.<span class="method">SetStates</span>(_cachedIntensityStatesDict);
        _stateMachine.<span class="method">ChangeState</span>(<span class="keyword">typeof</span>(<span class="class">DirectorRespiteState</span>));

        _intensityModifierDict = <span class="keyword">new</span> <span class="class">Dictionary</span>&lt;<span class="enumName">Difficulty</span>, <span class="keyword">float</span>&gt;
        {
            {<span class="enumName">Difficulty</span>.Easy, <span class="numericLiteral">30</span>},
            {<span class="enumName">Difficulty</span>.Normal, <span class="numericLiteral">60</span>},
            {<span class="enumName">Difficulty</span>.Hard, <span class="numericLiteral">90</span>}
        };
    }

    <span class="keyword">private void</span> <span class="method">Update</span>()
    {
        _stateMachine.<span class="method">Update</span>();
    }

    <span class="keyword">public void</span> <span class="method">IncreasePerceivedIntensity</span>() =&gt; <span class="method">StartCoroutine</span>(<span class="method">IncreasePerceivedIntensityCoroutine</span>());
    <span class="keyword">public void</span> <span class="method">DecreasePerceivedIntensity</span>() =&gt; <span class="method">StartCoroutine</span>(<span class="method">DecreasePerceivedIntensityCoroutine</span>());

    <span class="keyword">private</span> <span class="interface">IEnumerator</span> <span class="method">IncreasePerceivedIntensityCoroutine</span>()
    {
        <span class="keyword">float</span> <span class="localName">intensity</span> = _intensityCalculator.<span class="method">CalculatePerceivedIntensityOutput</span>(<span class="keyword">this</span>);
        _perceivedIntensity += <span class="localName">intensity</span> * _intensityModifierDict[difficulty] * <span class="class">Time</span>.deltaTime;

        <span class="control">if</span> (_perceivedIntensity &gt; <span class="numericLiteral">100</span>)
        {
            _perceivedIntensity = <span class="numericLiteral">100</span>;
        }

        <span class="control">yield return</span> <span class="keyword">new</span> <span class="class">WaitForSeconds</span>(intensityCalculationRate);
    }

    <span class="keyword">private</span> <span class="interface">IEnumerator</span> <span class="method">DecreasePerceivedIntensityCoroutine</span>()
    {
        <span class="keyword">float</span> <span class="localName">intensity</span> = _intensityCalculator.<span class="method">CalculatePerceivedIntensityOutput</span>(<span class="keyword">this</span>);
        _perceivedIntensity -= <span class="localName">intensity</span> * _intensityModifierDict[difficulty] * <span class="class">Time</span>.deltaTime;

        <span class="control">if</span> (_perceivedIntensity &lt; <span class="numericLiteral">0</span>)
        {
            _perceivedIntensity = <span class="numericLiteral">0</span>;
        }

        <span class="control">yield return</span> <span class="keyword">new</span> <span class="class">WaitForSeconds</span>(intensityCalculationRate);
    }

    <span class="keyword">public void</span> <span class="method">AddEnemy</span>(<span class="class">GameObject</span> <span class="parameter">enemy</span>)
    {
        activeEnemies.<span class="method">Add</span>(<span class="parameter">enemy</span>);
    }

    <span class="keyword">public void</span> <span class="method">RemoveEnemy</span>(<span class="class">GameObject</span> <span class="parameter">enemy</span>)
    {
        activeEnemies.<span class="method">Remove</span>(<span class="parameter">enemy</span>);
    }
    
    <span class="keyword">private void</span> <span class="method">StateMachineOnStateChangedEvent</span>()
    {
        <span class="class">DirectorEventBus</span>.<span class="method">Publish</span>(<span class="enumName">DirectorEvent</span>.EnteredNewState);
    }

    <span class="keyword">public</span> Player <span class="method">GetPlayer</span>() =&gt; player;

    <span class="keyword">public</span> <span class="interface">IState</span> <span class="method">GetDirectorState</span>() =&gt; _stateMachine.<span class="method">GetCurrentState</span>();

    <span class="keyword">public float</span> <span class="method">GetPeakIntensityThreshold</span>() =&gt; peakIntensityThreshold;
    <span class="keyword">public float</span> <span class="method">GetDefaultRespiteDuration</span>() =&gt; defaultRespiteDuration;
    <span class="keyword">public float</span> <span class="method">GetDefaultPeakDuration</span>() =&gt; defaultPeakDuration;

    <span class="keyword">public float</span> <span class="method">GetEnemyPopulationCount</span>() =&gt; activeEnemies.Count;
    <span class="keyword">public int</span> <span class="method">GetMaxRespitePopulation</span>() =&gt; maxRespitePopulation;
    <span class="keyword">public int</span> <span class="method">GetMaxBuildUpPopulation</span>() =&gt; maxBuildUpPopulation;
    <span class="keyword">public int</span> <span class="method">GetMaxPeakPopulation</span>() =&gt; maxPeakPopulation;

    <span class="keyword">public float</span> <span class="method">GetPerceivedIntensity</span>() =&gt; _perceivedIntensity;
    <span class="keyword">public float</span> <span class="method">GetIntensityCalculationRate</span>() =&gt; intensityCalculationRate;
    <span class="keyword">public float</span> <span class="method">GetIntensityScalar</span>() =&gt; _intensityModifierDict[difficulty];
};
</code>
        </pre>
        </div>


      <!--==========================-->
      <!--Code Snippet x - Event Bus-->
      <!--==========================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Event Bus</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public static class</span> <span class="class">DirectorEventBus</span>
{
    <span class="keyword">private static readonly</span> <span class="class">Dictionary</span>&lt;<span class="enumName">DirectorEvent</span>, <span class="enumName">Action</span>&gt; _eventsDict = <span class="keyword">new</span>();

    <span class="keyword">public static void</span> <span class="method">Subscribe</span>(<span class="enumName">DirectorEvent</span> <span class="parameter">eventName</span>, <span class="enumName">Action</span> <span class="parameter">listener</span>)
    {
        <span class="control">if</span> (_eventsDict.<span class="method">ContainsKey</span>(<span class="parameter">eventName</span>))
        {
            _eventsDict[<span class="parameter">eventName</span>] += <span class="parameter">listener</span>;
        }
        <span class="control">else</span>
        {
            _eventsDict.<span class="method">Add</span>(<span class="parameter">eventName</span>, <span class="parameter">listener</span>);
        }
    }

    <span class="keyword">public static void</span> <span class="method">Unsubscribe</span>(<span class="enumName">DirectorEvent</span> <span class="parameter">eventName</span>, <span class="enumName">Action</span> <span class="parameter">listener</span>)
    {
        <span class="control">if</span> (_eventsDict.<span class="method">ContainsKey</span>(<span class="parameter">eventName</span>))
        {
            _eventsDict[<span class="parameter">eventName</span>] -= <span class="parameter">listener</span>;
        }
    }

    <span class="keyword">public static void</span> <span class="method">Publish</span>(<span class="enumName">DirectorEvent</span> <span class="parameter">eventName</span>)
    {
        <span class="control">if</span> (_eventsDict.<span class="method">TryGetValue</span>(<span class="parameter">eventName</span>, <span class="keyword">out</span> <span class="enumName">Action</span> <span class="localName">thisEvent</span>))
        {
            <span class="localName">thisEvent</span>.<span class="method">Invoke</span>();
        }
    }
}</code>
          </pre>

      <!--=================================================-->
      <!--Code Snippet x - Director Event Bus Example Usage-->
      <!--=================================================-->
      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorEventTest</span> : <span class="class">MonoBehaviour</span>
{
    <span class="keyword">private void</span> <span class="method">OnEnable</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Subscribe</span>(<span class="enumName">DirectorEvent</span>.ReachedPeakIntensity, <span class="method">SomeMethod</span>);
    <span class="keyword">private void</span> <span class="method">OnDisable</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Unsubscribe</span>(<span class="enumName">DirectorEvent</span>.ReachedPeakIntensity, <span class="method">SomeMethod</span>);

    <span class="keyword">private void</span> <span class="method">SomeMethod</span>()
    {
        <span class="class">Debug</span>.<span class="method">Log</span>(<span class="string">&quot;Perceived intensity has reached the maximum threshold. &lt;color=red&gt;You Are Dead&lt;/color&gt;.&quot;</span>);
    }
}</code>
            </pre>
        </div>

        
      <br>  
      <h3 class="blogheader3">Rule Engine</h3>
      <!--==================================================-->
      <!--Code Snippet 1 - Director Intensity Rule Interface-->
      <!--==================================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Intensity Rule Interface</button>
      <div class="collapsibleblock">
          
        <br>
        <pre ><code><span class="keyword">public interface</span> <span class="interface">IDirectorIntensityRule</span>
{
    <span class="keyword">public float</span> <span class="method">CalculatePerceivedIntensity</span>(<span class="class">Director</span> <span class="parameter">director</span>);
}</code>
        </pre>
      </div>


      <!--===================================================-->
      <!--Code Snippet x - Director Intensity Rule Calculator-->
      <!--===================================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Intensity Rule Calculator</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorIntensityCalculator</span> 
{
    <span class="keyword">private</span> <span class="class">List</span>&lt;<span class="interface">IDirectorIntensityRule</span>&gt; _rules;

    <span class="keyword">public</span> <span class="class">DirectorIntensityCalculator</span>()
    {
        _rules = <span class="keyword">new</span> <span class="class">List</span>&lt;<span class="interface">IDirectorIntensityRule</span>&gt;
        {
            <span class="keyword">new</span> <span class="class">PassiveHauntIncreaseRule</span>()
        };
    }
    
    <span class="keyword">public float</span> <span class="method">CalculatePerceivedIntensityOutput</span>(<span class="class">Director</span> <span class="parameter">director</span>) 
    {
        <span class="keyword">var</span> <span class="localName">engine</span> = <span class="keyword">new</span> <span class="class">DirectorIntensityRuleEngine</span>(_rules);
        <span class="control">return</span> <span class="localName">engine</span>.<span class="method">CalculatePerceivedIntensityPercentage</span>(<span class="parameter">director</span>);
        
        <span class="comment">// Using the DirectorIntensityRuleEngine to evaluate the rules and produce an output</span>
        <span class="comment">// Outputs the greatest intensity value</span>
    }
}</code>
            </pre>
      </div>

        
      <!--===============================================-->
      <!--Code Snippet x - Director Intensity Rule Engine -->
      <!--===============================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Intensity Rule Engine</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorIntensityRuleEngine</span> 
{
    <span class="keyword">private readonly</span> <span class="class">List</span>&lt;<span class="interface">IDirectorIntensityRule</span>&gt; _rules = <span class="keyword">new</span> <span class="class">List</span>&lt;<span class="interface">IDirectorIntensityRule</span>&gt;();

    <span class="keyword">public</span> <span class="class">DirectorIntensityRuleEngine</span>(<span class="struct">IEnumerable</span>&lt;<span class="interface">IDirectorIntensityRule</span>&gt; <span class="parameter">rules</span>)
    {
        _rules.<span class="method">AddRange</span>(<span class="parameter">rules</span>); 
    }

    <span class="keyword">public float</span> <span class="method">CalculatePerceivedIntensityPercentage</span>(<span class="class">Director</span> <span class="parameter">director</span>) 
    {
        <span class="keyword">float</span> <span class="localName">intensity</span> = <span class="numericLiteral">0</span>; 
        <span class="control">foreach</span> (<span class="keyword">var</span> <span class="localName">rule</span> <span class="control">in</span> _rules)
        {
            <span class="localName">intensity</span> = <span class="enumName">Mathf</span>.<span class="method">Max</span>(<span class="localName">intensity</span>, <span class="localName">rule</span>.<span class="method">CalculatePerceivedIntensity</span>(<span class="parameter">director</span>));
            <span class="comment">// Applies the rule which outputs the greatest intensity weighting</span>
        }
        <span class="control">return</span> <span class="localName">intensity</span>;
    }
}</code>
      </pre>
      </div>  
        
      
      <br>
      <h3 class="blogheader3">State Machine</h3>
      <!--==============================-->
      <!--Code Snippet x - State Machine-->
      <!--==============================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>State Machine</button>
      <div class="collapsibleblock">

          <br>
          <pre class="background"><code><span class="keyword">public interface</span> <span class="interface">IState</span>
{
    <span class="keyword">public void</span> <span class="method">OnStateEnter</span>();
    <span class="keyword">public void</span> <span class="method">OnStateUpdate</span>();
    <span class="keyword">public void</span> <span class="method">OnStateExit</span>();
}</code>
          </pre>
          
          <br>
          <pre class="background"><code><span class="keyword">public class</span> <span class="class">StateMachine</span>
{
    <span class="keyword">private</span> <span class="interface">IState</span> _currentState;
    <span class="keyword">private</span> <span class="class">Dictionary</span>&lt;<span class="class">Type</span>, <span class="interface">IState</span>&gt; _availableStatesDict;
    <span class="keyword">public event</span> <span class="enumName">Action</span> OnStateChanged;

    <span class="keyword">public void</span> <span class="method">Update</span>()
    {
        <span class="control">if</span> (_currentState == <span class="keyword">null</span>)
        {
            _currentState = _availableStatesDict.Values.<span class="method">First</span>();
        }
        
        <span class="control">if</span> (_currentState != <span class="keyword">null</span>) _currentState.<span class="method">OnStateUpdate</span>();
    }
    
    <span class="keyword">public void</span> <span class="method">SetStates</span>(<span class="class">Dictionary</span>&lt;<span class="class">Type</span>, <span class="interface">IState</span>&gt; <span class="parameter">statesDict</span>)
    {
        _availableStatesDict = <span class="parameter">statesDict</span>;
    }

    <span class="keyword">public void</span> <span class="method">ChangeState</span>(<span class="class">Type</span> <span class="parameter">newState</span>)
    {
        <span class="control">if</span> (_currentState != <span class="keyword">null</span>) _currentState.<span class="method">OnStateExit</span>();

        _currentState = _availableStatesDict[<span class="parameter">newState</span>];
        _currentState.<span class="method">OnStateEnter</span>();
        OnStateChanged?.<span class="method">Invoke</span>();
    }

    <span class="keyword">public</span> <span class="interface">IState</span> <span class="method">GetCurrentState</span>()
    {
        <span class="control">return</span> _currentState;
    }
}</code>
          </pre>
      </div>


      <!--========================================-->
      <!--Code Snippet x - Director Respite State-->
      <!--========================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Respite State</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorRespiteState</span> : <span class="interface">IState</span>
{
    <span class="keyword">private</span> <span class="class">Director</span> _director;
    <span class="keyword">private</span> <span class="class">StateMachine</span> _stateMachine;
    
    <span class="keyword">public</span> <span class="class">DirectorRespiteState</span>(<span class="class">Director</span> <span class="parameter">director</span>, <span class="class">StateMachine</span> <span class="parameter">stateMachine</span>)
    {
        _director = <span class="parameter">director</span>;
        _stateMachine = <span class="parameter">stateMachine</span>;
    }

    <span class="keyword">public void</span> <span class="method">OnStateEnter</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Publish</span>(<span class="class">DirectorEvent</span>.EnteredRespiteState);

    <span class="keyword">public void</span> <span class="method">OnStateUpdate</span>()
    {
        _director.RespiteDuration -= <span class="class">Time</span>.deltaTime;
        
        <span class="control">if</span> (_director.RespiteDuration &lt;= <span class="numericLiteral">0</span>)
        {
            _director.MaxPopulationCount = _director.<span class="method">GetMaxBuildUpPopulation</span>();
            _director.RespiteDuration = _director.<span class="method">GetDefaultRespiteDuration</span>(); 
            _stateMachine.<span class="method">ChangeState</span>(<span class="keyword">typeof</span>(DirectorBuildUpState));
        }
    }

    <span class="keyword">public void</span> <span class="method">OnStateExit</span>() {}
}</code>
      </pre>
      </div>


      <!--========================================-->
      <!--Code Snippet x - Director Build-up State-->
      <!--========================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director BuildUp State</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorBuildUpState</span> : <span class="interface">IState</span>
{
    <span class="keyword">private</span> <span class="class">Director</span> _director;
    <span class="keyword">private</span> <span class="class">StateMachine</span> _stateMachine;
    
    <span class="keyword">public</span> <span class="class">DirectorBuildUpState</span>(<span class="class">Director</span> <span class="parameter">director</span>, <span class="class">StateMachine</span> <span class="parameter">stateMachine</span>)
    {
        _director = <span class="parameter">director</span>;
        _stateMachine = <span class="parameter">stateMachine</span>;
    }

    <span class="keyword">public void</span> <span class="method">OnStateEnter</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Publish</span>(<span class="enumName">DirectorEvent</span>.EnteredBuildUpState);

    <span class="keyword">public void</span> <span class="method">OnStateUpdate</span>()
    {
        _director.<span class="method">IncreasePerceivedIntensity</span>();
        
        <span class="control">if</span> (_director.<span class="method">GetPerceivedIntensity</span>() &gt;= _director.<span class="method">GetPeakIntensityThreshold</span>())
        {
            _director.MaxPopulationCount = _director.<span class="method">GetMaxPeakPopulation</span>();
            _stateMachine.<span class="method">ChangeState</span>(<span class="keyword">typeof</span>(DirectorPeakState));
        }
    }

    <span class="keyword">public void</span> <span class="method">OnStateExit</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Publish</span>(<span class="enumName">DirectorEvent</span>.ReachedPeakIntensity);
}</code>
      </pre>
      </div>


      <!--========================================-->
      <!--Code Snippet x - Director Peak State-->
      <!--========================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Peak State</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorPeakState</span> : <span class="interface">IState</span>
{
    <span class="keyword">private</span> <span class="class">Director</span> _director;
    <span class="keyword">private</span> <span class="class">StateMachine</span> _stateMachine;
    
    <span class="keyword">public</span> <span class="class">DirectorPeakState</span>(<span class="class">Director</span> <span class="parameter">director</span>, <span class="class">StateMachine</span> <span class="parameter">stateMachine</span>)
    {
        _director = <span class="parameter">director</span>;
        _stateMachine = <span class="parameter">stateMachine</span>;
    }

    <span class="keyword">public void</span> <span class="method">OnStateEnter</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Publish</span>(<span class="class">DirectorEvent</span>.EnteredPeakState);

    <span class="keyword">public void</span> <span class="method">OnStateUpdate</span>()
    {
        _director.PeakDuration -= <span class="class">Time</span>.deltaTime;
        
        <span class="control">if</span>(_director.PeakDuration &lt;= <span class="numericLiteral">0</span>)
        {
            _director.MaxPopulationCount = <span class="numericLiteral">0</span>;
            _director.PeakDuration = _director.<span class="method">GetDefaultPeakDuration</span>(); 
            _stateMachine.<span class="method">ChangeState</span>(<span class="keyword">typeof</span>(DirectorPeakFadeState));
        }
    }

    <span class="keyword">public void</span> <span class="method">OnStateExit</span>() {}
}</code>
      </pre>
      </div>


      <!--========================================-->
      <!--Code Snippet x - Director PeakFade State-->
      <!--========================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director PeakFade State</button>
      <div class="collapsibleblock">

      <br>
      <pre class="background"><code><span class="keyword">public class</span> <span class="class">DirectorPeakFadeState</span> : <span class="interface">IState</span>
{
    <span class="keyword">private</span> <span class="class">Director</span> _director;
    <span class="keyword">private</span> <span class="class">StateMachine</span> _stateMachine;
    
    <span class="keyword">public</span> <span class="class">DirectorPeakFadeState</span>(<span class="class">Director</span> <span class="parameter">director</span>, <span class="class">StateMachine</span> <span class="parameter">stateMachine</span>)
    {
        _director = <span class="parameter">director</span>;
        _stateMachine = <span class="parameter">stateMachine</span>;
    }

    <span class="keyword">public void</span> <span class="method">OnStateEnter</span>() =&gt; <span class="class">DirectorEventBus</span>.<span class="method">Publish</span>(<span class="class">DirectorEvent</span>.EnteredPeakFadeState);

    <span class="keyword">public void</span> <span class="method">OnStateUpdate</span>()
    {
        _director.<span class="method">DecreasePerceivedIntensity</span>();
        
        <span class="control">if</span> (_director.<span class="method">GetEnemyPopulationCount</span>() == <span class="numericLiteral">0</span> &amp;&amp; _director.<span class="method">GetPerceivedIntensity</span>() == <span class="numericLiteral">0</span>)
        {
            _director.MaxPopulationCount = _director.<span class="method">GetMaxRespitePopulation</span>();
            _stateMachine.<span class="method">ChangeState</span>(<span class="keyword">typeof</span>(DirectorRespiteState));
        }
    }

    <span class="keyword">public void</span> <span class="method">OnStateExit</span>() {}
}</code>
      </pre>
      </div>


      <br>
      <h3 class="blogheader3">Unity Inspector</h3>
      <!--========================================-->
      <!--Code Snippet x - Director Inspector View-->
      <!--========================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-file-code" style="color: rgb(132,123,255); margin-top: 0.15em;  margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Inspector View</button>
      <div class="collapsibleblock">
          <br>
          <img src="../images/DirectorAiProject/DirectorInspectorView.png" alt="Director Inspector View">
      </div>
        
        
      <!--========================================================-->
      <!--Code Snippet x - Director Active Area Set Inspector View-->
      <!--========================================================-->
      <button type="button" class="collapsible"><span class="fa-solid fa-file-code" style="color: rgb(132,123,255); margin-top: 0.15em; margin-right: 0.5em; float: left; font-size: 1em;"></span>Director Active Area Set</button>
      <div class="collapsibleblock">
          <br>
          <img src="../images/DirectorAiProject/ActiveAreaSetInspectorView.png" alt="ActiveAreaSet Inspector View">
      </div>

        
      <br>
      <h2 class="blogheader2" style="color: white;">Other Resources</h2>
      <a href="../documents/CCTPFinalReport.pdf" target="_blank" style="color: #a8a8a8;"><span class="fa-solid fa-file-lines" style="margin-right: 5px;"></span>Thesis Paper</a>
      <span> | </span>
      <a href="https://github.com/charlie2099/Director-Ai-For-Survival-and-Shooter-Games" target="_blank" style="color: #a8a8a8;"><span class="fab fa-github" style="margin-right: 5px;"></span>GitHub Repository</a>
      <span> | </span>
      <a href="https://youtu.be/Y1wvqfNqyqQ" target="_blank" style="color: #a8a8a8;"><span class="fab fa-youtube" style="margin-right: 5px;"></span>Project Showcase</a>
        
      <br>
      <br>
        
      <!--<br>
      <br>
      <h2 class="blogheader2" style="color: white;">References</h2>
      <p>Lorem ipsum.</p>  -->
        
        
    </div> <!--End of Inner-->
  </div> <!--End of Main-->

  <!-- Footer -->
  <footer id="footer">
    <div class="inner" style="max-width: 50em; margin: 0 auto;">
      <section>
        <h2>Contact</h2>
        <ul class="icons">
          <li><a href="https://github.com/charlie2099" target="_blank" class="fab fa-github icon brands"><span class="label">GitHub</span></a></li>
          <li><a href="https://charlie2099.itch.io/" target="_blank" class="fab fa-itch-io icon brands"><span class="label">Itch Io</span></a></li>
          <li><a href="https://www.linkedin.com/in/charlie-evans-5bbaa3200" target="_blank" class="fab fa-linkedin icon brands"><span class="label">Linkedin</span></a></li>
          <li><a href="mailto:charlie.evans2499@gmail.com" target="_blank" class="fab fa-envelope icon"><span class="label">Email</span></a></li>
          <li><a href="https://twitter.com/charlieevans203" target="_blank" class="fab fa-twitter icon brands"><span class="label">Twitter</span></a></li>
          <li><a href="https://uwegames.slack.com/team/U02H9M78J6A" target="_blank" class="fab fa-slack icon brands"><span class="label">Slack</span></a></li>
        </ul>
        <p>&copy; Charlie Evans. All rights reserved. | Homepage Design Template: <a href="https://html5up.net/phantom" target="_blank">Phantom HTML5 UP</a></p>
      </section>
    </div>
  </footer>

</div>

<!-- Scripts -->
<script src="../assets/js/collapsiblecontent.js"></script>
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/browser.min.js"></script>
<script src="../assets/js/breakpoints.min.js"></script>
<script src="../assets/js/util.js"></script>
<script src="../assets/js/main.js"></script>

</body>
</html>